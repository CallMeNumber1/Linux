## 多进程

#### 共享内存

- 概念
  - 多个进程共享同一块内存区域,同一块内存分别映射到不同的进程空间中.
  - 需要某种同步机制:互斥锁或信号量
- 效率
  - 进程可以直接读写内存而不需要任何数据的拷贝,通信效率高
- 特点
  - 共享内存是两个正在运行的进程之间共享和传递数据的最有效的方式 
  - 共享内存不提供任何互斥和同步机制，一般用信号量对临界资源进行保护

#### 信号量

- 概念
  - 信号量是一个计数器，可以用来控制多个线程对共享资源的访问
  - 作为一种锁机制，防止某进程在访问资源时其他进程也来访问
  - 主要作为进程间以及同一进程的不同线程间的同步手段

## 多线程

- 概念
  - 线程被称为轻量级的进程.
  - 同一进程内的多条线程共享该进程中的全部资源,如虚拟地址空间,文件描述符和信号处理等.
- 基本操作
  - pthread_create
  - pthread_exit
  - pthread_join
- 多线程的同步与互斥
  - 实际应用中多个线程往往会访问共享的资源,因此就需要对多个线程进行同步,对其访问的数据予以保护.
  - 锁
    - pthread_mutex_lock
    - pthread_mutex_unlock
    - 锁要保护的并不是我们的共享变量(或者说共享内存),对于共享的内存而言，用户是无法直接对其保护的，因为那是物理内存，无法阻止其他程序的代码访问。
    - 加锁是会带来额外的开销的，加锁的代码其运行速度，明显比不加锁的要慢一些
  - 信号量
    - 信号量本质上是一个非负数的整数计数器，它也被用来控制对公共资源的访问。当公共资源增加的时候，调用信号量增加函数sem_post()对其进行增加，当公共资源减少的时候，调用函数sem_wait()来减少信号量
    - sem_wait() sem_post()

## 多进程和多线程的区别

多线程的优点

- 创建进程的空间和时间开销要大于线程,进程之间有着不同的地址空间,而同一进程里的多线程则使用同一地址空间,共享该进程里的堆,数据段.
- 线程间共享内存,通信方便
- 不用切换地址空间
- 当不同任务间需要大量数据或频繁通信时,推荐使用

多进程的优点

- 更强的鲁棒性:一个进程crash不会导致整个系统崩溃
  - chrome的标签页即是应用